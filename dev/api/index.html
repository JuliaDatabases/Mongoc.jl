<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Mongoc.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Mongoc.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../crud/">CRUD Operations</a></li><li><a class="tocitem" href="../authentication/">Authentication</a></li><li><a class="tocitem" href="../transaction/">Transactions</a></li><li><a class="tocitem" href="../connection_pool/">Connection Pool</a></li><li><a class="tocitem" href="../gridfs/">GridFS</a></li><li><a class="tocitem" href="../logging/">Logging</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#BSON"><span>BSON</span></a></li><li><a class="tocitem" href="#Client"><span>Client</span></a></li><li><a class="tocitem" href="#ClientPool"><span>ClientPool</span></a></li><li><a class="tocitem" href="#Database"><span>Database</span></a></li><li><a class="tocitem" href="#Collection"><span>Collection</span></a></li><li><a class="tocitem" href="#Aggregation"><span>Aggregation</span></a></li><li><a class="tocitem" href="#Session"><span>Session</span></a></li><li><a class="tocitem" href="#GridFS"><span>GridFS</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/felipenoris/Mongoc.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="BSON"><a class="docs-heading-anchor" href="#BSON">BSON</a><a id="BSON-1"></a><a class="docs-heading-anchor-permalink" href="#BSON" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.BSON" href="#Mongoc.BSON"><code>Mongoc.BSON</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A <code>BSON</code> represents a document in <em>Binary JSON</em> format, defined at http://bsonspec.org/.</p><p>In Julia, you can manipulate a <code>BSON</code> instance just like a <code>Dict</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">bson = Mongoc.BSON()
bson[&quot;name&quot;] = &quot;my name&quot;
bson[&quot;num&quot;] = 10.0</code></pre><p><strong>C API</strong></p><p><code>BSON</code> is a wrapper for C struct <code>bson_t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L178-L196">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.BSONObjectId" href="#Mongoc.BSONObjectId"><code>Mongoc.BSONObjectId</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A <code>BSONObjectId</code> represents a unique identifier for a BSON document.</p><p><strong>Example</strong></p><p>The following generates a new <code>BSONObjectId</code>.</p><pre><code class="language-julia hljs">julia&gt; Mongoc.BSONObjectId()</code></pre><p><strong>C API</strong></p><p><code>BSONObjectId</code> instances addresses are passed to libbson/libmongoc API using <code>Ref(oid)</code>, and are owned by the Julia process.</p><p>Mirrors C struct <code>bson_oid_t</code>:</p><pre><code class="language-c hljs">typedef struct {
   uint8_t bytes[12];
} bson_oid_t;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L78-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.BSONCode" href="#Mongoc.BSONCode"><code>Mongoc.BSONCode</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>BSONCode</code> is a BSON element with JavaScript source code.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; bson = Mongoc.BSON(&quot;source&quot; =&gt; Mongoc.BSONCode(&quot;function() = 1&quot;))
BSON(&quot;{ &quot;source&quot; : { &quot;$code&quot; : &quot;function() = 1&quot; } }&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L155-L165">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.as_json" href="#Mongoc.as_json"><code>Mongoc.as_json</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">as_json(bson::BSON; canonical::Bool=false) :: String</code></pre><p>Converts a <code>bson</code> object to a JSON string.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; document = Mongoc.BSON(&quot;{ &quot;hey&quot; : 1 }&quot;)
BSON(&quot;{ &quot;hey&quot; : 1 }&quot;)

julia&gt; Mongoc.as_json(document)
&quot;{ &quot;hey&quot; : 1 }&quot;

julia&gt; Mongoc.as_json(document, canonical=true)
&quot;{ &quot;hey&quot; : { &quot;$numberInt&quot; : &quot;1&quot; } }&quot;</code></pre><p><strong>C API</strong></p><ul><li><p><a href="http://mongoc.org/libbson/current/bson_as_canonical_extended_json.html"><code>bson_as_canonical_extended_json</code></a></p></li><li><p><a href="http://mongoc.org/libbson/current/bson_as_relaxed_extended_json.html"><code>bson_as_relaxed_extended_json</code></a></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L383-L406">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.as_dict" href="#Mongoc.as_dict"><code>Mongoc.as_dict</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">as_dict(document::BSON) :: Dict</code></pre><p>Converts a BSON document to a Julia <code>Dict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L501-L505">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.get_array" href="#Mongoc.get_array"><code>Mongoc.get_array</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_array(doc::BSON, key::AbstractString, ::Type{T})</code></pre><p>Get an array from the document with a specified type <code>T</code>. This allows obtaining a type-stable return value. Note that if an array element cannot be converted to the specified type, an error will be thrown.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L522-L528">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.read_bson" href="#Mongoc.read_bson"><code>Mongoc.read_bson</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_bson(io::IO) :: Vector{BSON}</code></pre><p>Reads all BSON documents from <code>io</code>. This method will continue to read from <code>io</code> until it reaches eof.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L919-L925">source</a></section><section><div><pre><code class="nohighlight hljs">read_bson(data::Vector{UInt8}) :: Vector{BSON}</code></pre><p>Parses a vector of bytes to a vector of BSON documents. Useful when reading BSON as binary from a stream.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L928-L933">source</a></section><section><div><pre><code class="nohighlight hljs">read_bson(filepath::AbstractString) :: Vector{BSON}</code></pre><p>Reads all BSON documents from a file located at <code>filepath</code>.</p><p>This will open a <code>Mongoc.BSONReader</code> pointing to the file and will parse file contents to BSON documents.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L960-L967">source</a></section><section><div><pre><code class="nohighlight hljs">read_bson(reader::BSONReader) :: Vector{BSON}</code></pre><p>Reads all BSON documents from a <code>reader</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L1064-L1068">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.write_bson" href="#Mongoc.write_bson"><code>Mongoc.write_bson</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_bson(io::IO, bson::BSON;
    initial_buffer_capacity::Integer=DEFAULT_BSON_WRITER_BUFFER_CAPACITY)</code></pre><p>Writes a single BSON document to <code>io</code> in binary format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L833-L838">source</a></section><section><div><pre><code class="nohighlight hljs">write_bson(io::IO, bson_list::Vector{BSON};
    initial_buffer_capacity::Integer=DEFAULT_BSON_WRITER_BUFFER_CAPACITY)</code></pre><p>Writes a vector of BSON documents to <code>io</code> in binary format.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">list = Vector{Mongoc.BSON}()

let
    src = Mongoc.BSON()
    src[&quot;id&quot;] = 1
    src[&quot;name&quot;] = &quot;1st&quot;
    push!(list, src)
end

let
    src = Mongoc.BSON()
    src[&quot;id&quot;] = 2
    src[&quot;name&quot;] = &quot;2nd&quot;
    push!(list, src)
end

open(&quot;documents.bson&quot;, &quot;w&quot;) do io
    Mongoc.write_bson(io, list)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L875-L904">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.read_next_bson" href="#Mongoc.read_next_bson"><code>Mongoc.read_next_bson</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_next_bson(reader::BSONReader) :: Union{Nothing, BSON}</code></pre><p>Reads the next BSON document available in the stream pointed by <code>reader</code>. Returns <code>nothing</code> if reached the end of the stream.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L988-L993">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.BSONError" href="#Mongoc.BSONError"><code>Mongoc.BSONError</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>BSONError</code> is the default <code>Exception</code> for BSON/MongoDB function call errors.</p><p><strong>C API</strong></p><p>Mirrors C struct <code>bson_error_t</code>.</p><p><code>BSONError</code> instances addresses are passed to libbson/libmongoc API using <code>Ref(error)</code>, and are owned by the Julia process.</p><pre><code class="language-c hljs">typedef struct {
   uint32_t domain;
   uint32_t code;
   char message[504];
} bson_error_t;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L129-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.BSONValue" href="#Mongoc.BSONValue"><code>Mongoc.BSONValue</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Wrapper for bson<em>value</em>t.</p><p>See <a href="#Mongoc.get_as_bson_value"><code>Mongoc.get_as_bson_value</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L217-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.get_as_bson_value" href="#Mongoc.get_as_bson_value"><code>Mongoc.get_as_bson_value</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_as_bson_value(doc, key) :: BSONValue</code></pre><p>Returns a value stored in a bson document <code>doc</code> as a <code>BSONValue</code>.</p><p>See also <a href="@ref">Mongoc.BSONValue</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L626-L633">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.read_bson_from_json" href="#Mongoc.read_bson_from_json"><code>Mongoc.read_bson_from_json</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_bson_from_json(filepath::AbstractString) :: Vector{BSON}</code></pre><p>Reads a JSON file into a list of BSON documents. The file should contain a sequence of valid JSON documents.</p><p><strong>Example of a valid JSON file</strong></p><pre><code class="language-json hljs">{ &quot;num&quot; : 1, &quot;str&quot; : &quot;two&quot; }
{ &quot;num&quot; : 2, &quot;str&quot; : &quot;three&quot; }</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/bson.jl#L1077-L1089">source</a></section></article><h2 id="Client"><a class="docs-heading-anchor" href="#Client">Client</a><a id="Client-1"></a><a class="docs-heading-anchor-permalink" href="#Client" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.Client" href="#Mongoc.Client"><code>Mongoc.Client</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Client(host, port)
Client(uri)
Client()
Client(pool; [try_pop=false])</code></pre><p>Creates a <code>Client</code>, which represents a connection to a MongoDB database.</p><p>See also <a href="#Mongoc.ClientPool"><code>Mongoc.ClientPool</code></a>.</p><p><strong>Examples:</strong></p><p>These lines are equivalent.</p><pre><code class="language-julia hljs">c = Mongoc.Client()
c = Mongoc.Client(&quot;localhost&quot;, 27017)
c = Mongoc.Client(&quot;mongodb://localhost:27017&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L6-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.set_appname!" href="#Mongoc.set_appname!"><code>Mongoc.set_appname!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_appname!(client::Client, appname::String)</code></pre><p>Sets the application name for this client.</p><p>This string, along with other internal driver details, is sent to the server as part of the initial connection handshake.</p><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_client_set_appname.html"><code>mongoc_client_set_appname</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L30-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.ping" href="#Mongoc.ping"><code>Mongoc.ping</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ping(client::Client) :: BSON</code></pre><p>Pings the server, testing wether it is reachable.</p><p>One thing to keep in mind is that operations on MongoDB are <em>lazy</em>, which means that a client reaches a server only when it needs to transfer documents.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; client = Mongoc.Client() # nothing happens here between client and server
Client(URI(&quot;mongodb://localhost:27017&quot;))

julia&gt; Mongoc.ping(client) # connection to server happens here
BSON(&quot;{ &quot;ok&quot; : 1.0 }&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L50-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.get_server_mongodb_version" href="#Mongoc.get_server_mongodb_version"><code>Mongoc.get_server_mongodb_version</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_server_mongodb_version(client::Client) :: VersionNumber</code></pre><p>Queries the version for the MongoDB server instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_databases" href="#Mongoc.find_databases"><code>Mongoc.find_databases</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_databases(client::Client; options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Queries for databases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.get_database_names" href="#Mongoc.get_database_names"><code>Mongoc.get_database_names</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_database_names(client::Client; options::Union{Nothing, BSON}=nothing) :: Vector{String}</code></pre><p>Helper method to get a list of names for all databases.</p><p>See also <a href="#Mongoc.find_databases"><code>Mongoc.find_databases</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L97-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.has_database" href="#Mongoc.has_database"><code>Mongoc.has_database</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">has_database(client::Client, database_name::String;
    options::Union{Nothing, BSON}=nothing) :: Bool</code></pre><p>Helper method to check if there is a database named <code>database_name</code>.</p><p>See also <a href="#Mongoc.find_databases"><code>Mongoc.find_databases</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/client.jl#L112-L119">source</a></section></article><h2 id="ClientPool"><a class="docs-heading-anchor" href="#ClientPool">ClientPool</a><a id="ClientPool-1"></a><a class="docs-heading-anchor-permalink" href="#ClientPool" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.ClientPool" href="#Mongoc.ClientPool"><code>Mongoc.ClientPool</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ClientPool(uri; [max_size])</code></pre><p>Creates a pool of connections to a MongoDB instance.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">const REPLICA_SET_URL = &quot;mongodb://127.0.0.1:27021,127.0.0.1:27022,127.0.0.1:27023/?replicaSet=rs0&quot;

pool = Mongoc.ClientPool(REPLICA_SET_URL, max_size=2)

# create Clients from a pool
client1 = Mongoc.Client(pool)
client2 = Mongoc.Client(pool)</code></pre><p>When you reach the maximum number of clients, the next call to <code>Mongoc.Client(pool)</code> will block until a <code>Client</code> is released.</p><p>Use <code>try_pop=true</code> option to throw an error instead of blocking the current thread:</p><pre><code class="language-julia hljs"># will throw `AssertionError`
client3 = Mongoc.Client(pool, try_pop=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/clientpool.jl#L2-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.set_max_size" href="#Mongoc.set_max_size"><code>Mongoc.set_max_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_max_size(pool, max_size)</code></pre><p>Set the maximum number of clients on the client pool.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">const REPLICA_SET_URL = &quot;mongodb://127.0.0.1:27021,127.0.0.1:27022,127.0.0.1:27023/?replicaSet=rs0&quot;
pool = Mongoc.ClientPool(REPLICA_SET_URL)

Mongoc.set_max_size(pool, 4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/clientpool.jl#L35-L48">source</a></section></article><h2 id="Database"><a class="docs-heading-anchor" href="#Database">Database</a><a id="Database-1"></a><a class="docs-heading-anchor-permalink" href="#Database" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.command_simple" href="#Mongoc.command_simple"><code>Mongoc.command_simple</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">command_simple(database::Database, command::BSON) :: BSON
command_simple(collection::Collection, command::BSON) :: BSON</code></pre><p>Executes a <code>command</code> given by a JSON string or a BSON instance.</p><p>It returns the first document from the result cursor.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; client = Mongoc.Client() # connects to localhost at port 27017
Client(URI(&quot;mongodb://localhost:27017&quot;))

julia&gt; bson_result = Mongoc.command_simple(client[&quot;admin&quot;], &quot;{ &quot;ping&quot; : 1 }&quot;)
BSON(&quot;{ &quot;ok&quot; : 1.0 }&quot;)</code></pre><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_database_command_simple.html"><code>mongoc_database_command_simple</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L5-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.add_user" href="#Mongoc.add_user"><code>Mongoc.add_user</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">add_user(database::Database, username::String, password::String, roles::Union{Nothing, BSON},
    custom_data::Union{Nothing, BSON}=nothing)</code></pre><p>This function shall create a new user with access to database.</p><p><strong>Warning:</strong> Do not call this function without TLS.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L82-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.remove_user" href="#Mongoc.remove_user"><code>Mongoc.remove_user</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">remove_user(database::Database, username::String)</code></pre><p>Removes a user from database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.has_user" href="#Mongoc.has_user"><code>Mongoc.has_user</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">has_user(database::Database, user_name::String) :: Bool</code></pre><p>Checks if <code>database</code> has a user named <code>user_name</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_collections" href="#Mongoc.find_collections"><code>Mongoc.find_collections</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_collections(database::Database; options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Queries for collections in a <code>database</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L128-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.get_collection_names" href="#Mongoc.get_collection_names"><code>Mongoc.get_collection_names</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_collection_names(database::Database;
    options::Union{Nothing, BSON}=nothing) :: Vector{String}</code></pre><p>Helper method to get collection names.</p><p>See also <a href="#Mongoc.find_collections"><code>Mongoc.find_collections</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L142-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.read_command" href="#Mongoc.read_command"><code>Mongoc.read_command</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_command(database::Database, command::BSON;
    options::Union{Nothing, BSON}=nothing) :: BSON</code></pre><p>Issue a command with read semantics.</p><p>See http://mongoc.org/libmongoc/current/mongoc<em>database</em>read<em>command</em>with_opts.html.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L60-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.write_command" href="#Mongoc.write_command"><code>Mongoc.write_command</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_command(database::Database, command::BSON;
    options::Union{Nothing, BSON}=nothing) :: BSON</code></pre><p>Issue a command with write semantics.</p><p>See http://mongoc.org/libmongoc/current/mongoc<em>database</em>read<em>write</em>command<em>with</em>opts.html.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/database.jl#L38-L45">source</a></section></article><h2 id="Collection"><a class="docs-heading-anchor" href="#Collection">Collection</a><a id="Collection-1"></a><a class="docs-heading-anchor-permalink" href="#Collection" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find" href="#Mongoc.find"><code>Mongoc.find</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find(collection::Collection, bson_filter::BSON=BSON();
    options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Executes a query on <code>collection</code> and returns an iterable <code>Cursor</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">function find_contract_codes(collection, criteria::Dict=Dict()) :: Vector{String}
    result = Vector{String}()

    let
        bson_filter = Mongoc.BSON(criteria)
        bson_options = Mongoc.BSON(&quot;&quot;&quot;{ &quot;projection&quot; : { &quot;_id&quot; : true }, &quot;sort&quot; : { &quot;_id&quot; : 1 } }&quot;&quot;&quot;)
        for bson_document in Mongoc.find(collection, bson_filter, options=bson_options)
            push!(result, bson_document[&quot;_id&quot;])
        end
    end

    return result
end</code></pre><p>Check the <a href="http://mongoc.org/libmongoc/current/mongoc_collection_find_with_opts.html">libmongoc documentation</a> for more information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L241-L267">source</a></section><section><div><pre><code class="nohighlight hljs">find(bucket::Bucket, bson_filter::BSON=BSON();
    options::BSON=BSON()) :: Cursor</code></pre><p>Looks for files in GridFS bucket.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_one" href="#Mongoc.find_one"><code>Mongoc.find_one</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_one(collection::Collection, bson_filter::BSON=BSON();
    options::Union{Nothing, BSON}=nothing) :: Union{Nothing, BSON}</code></pre><p>Execute a query to a collection and returns the first element of the result set.</p><p>Returns <code>nothing</code> if the result set is empty.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L319-L326">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.count_documents" href="#Mongoc.count_documents"><code>Mongoc.count_documents</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">count_documents(collection::Collection, bson_filter::BSON=BSON();
    options::Union{Nothing, BSON}=nothing) :: Int</code></pre><p>Returns the number of documents on a <code>collection</code>, with an optional filter given by <code>bson_filter</code>.</p><p><code>length(collection)</code> and <code>Mongoc.count_documents(collection)</code> produces the same output.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">result = length(collection, Mongoc.BSON(&quot;_id&quot; =&gt; oid))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L281-L296">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.drop" href="#Mongoc.drop"><code>Mongoc.drop</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">drop(database::Database, opts::Union{Nothing, BSON}=nothing)
drop(collection::Collection, opts::Union{Nothing, BSON}=nothing)</code></pre><p>Drops <code>database</code> or <code>collection</code>.</p><p>For information about <code>opts</code> argument, check the libmongoc documentation for <a href="http://mongoc.org/libmongoc/current/mongoc_database_drop_with_opts.html">database drop</a> or <a href="http://mongoc.org/libmongoc/current/mongoc_collection_drop_with_opts.html">collection drop</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L398-L408">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_and_modify" href="#Mongoc.find_and_modify"><code>Mongoc.find_and_modify</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_and_modify(collection::Collection, query::BSON;
    update::Union{Nothing, BSON}=nothing,
    sort::Union{Nothing, BSON}=nothing,
    fields::Union{Nothing, BSON}=nothing,
    flags::Union{Nothing, FindAndModifyFlags}=nothing,
    bypass_document_validation::Bool=false,
) :: BSON</code></pre><p>Find documents and updates them in one go.</p><p>See <a href="#Mongoc.FindAndModifyFlags"><code>Mongoc.FindAndModifyFlags</code></a> for a list of accepted values for <code>flags</code> argument.</p><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_collection_find_and_modify.html">mongoc<em>collection</em>find<em>and</em>modify</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L486-L503">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.FindAndModifyFlags" href="#Mongoc.FindAndModifyFlags"><code>Mongoc.FindAndModifyFlags</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Adds one or more flags to the <code>FindAndModifyOptsBuilder</code>. These flags can be <em>ORed</em> together, as in <code>flags = Mongoc.FIND_AND_MODIFY_FLAG_UPSERT | Mongoc.FIND_AND_MODIFY_FLAG_RETURN_NEW</code>.</p><ul><li><p><code>FIND_AND_MODIFY_FLAG_NONE</code>: Default. Doesn’t add anything to the builder.</p></li><li><p><code>FIND_AND_MODIFY_FLAG_REMOVE</code>: Will instruct find<em>and</em>modify to remove the matching document.</p></li><li><p><code>FIND_AND_MODIFY_FLAG_UPSERT</code>: Update the matching document or, if no document matches, insert the document.</p></li><li><p><code>FIND_AND_MODIFY_FLAG_RETURN_NEW</code>: Return the resulting document.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/types.jl#L45-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_one_and_delete" href="#Mongoc.find_one_and_delete"><code>Mongoc.find_one_and_delete</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_one_and_delete(collection::Collection, bson_filter::BSON;
    options::Union{Nothing, BSON}=nothing
) :: Union{Nothing, BSON}</code></pre><p>Delete a document and return it.</p><p>See <a href="https://docs.mongodb.com/manual/reference/method/db.collection.findOneAndDelete/">db.collection.findOneAndDelete</a>  for a list of accepted options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L543-L552">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_one_and_replace" href="#Mongoc.find_one_and_replace"><code>Mongoc.find_one_and_replace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_one_and_replace(collection::Collection, bson_filter::BSON, bson_replacement::BSON;
    options::Union{Nothing, BSON}=nothing
) :: Union{Nothing, BSON}</code></pre><p>Replace a document and return the original.</p><p>See <a href="https://docs.mongodb.com/manual/reference/method/db.collection.findOneAndReplace/">db.collection.findOneAndReplace</a>  for a list of accepted options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L629-L638">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.find_one_and_update" href="#Mongoc.find_one_and_update"><code>Mongoc.find_one_and_update</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_one_and_update(collection::Collection, bson_filter::BSON, bson_update::BSON;
    options::Union{Nothing, BSON}=nothing
) :: Union{Nothing, BSON}</code></pre><p>Update a document and return the original.</p><p>See <a href="https://docs.mongodb.com/manual/reference/method/db.collection.findOneAndUpdate/">db.collection.findOneAndUpdate</a>  for a list of accepted options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L652-L661">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.replace_one" href="#Mongoc.replace_one"><code>Mongoc.replace_one</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">replace_one(
        collection::Collection,
        selector::BSON,
        replacement::BSON;
        options::Union{Nothing, BSON}=nothing
    )</code></pre><p>Replace the result of querying by <code>selector</code> with <code>replacement</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L118-L127">source</a></section></article><h2 id="Aggregation"><a class="docs-heading-anchor" href="#Aggregation">Aggregation</a><a id="Aggregation-1"></a><a class="docs-heading-anchor-permalink" href="#Aggregation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.aggregate" href="#Mongoc.aggregate"><code>Mongoc.aggregate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">aggregate(collection::Collection, bson_pipeline::BSON;
    flags::QueryFlags=QUERY_FLAG_NONE,
    options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Use <code>Mongoc.aggregate</code> to execute an aggregation command.</p><p><strong>Example</strong></p><p>The following reproduces the example from the <a href="https://docs.mongodb.com/manual/aggregation/">MongoDB Tutorial</a>.</p><pre><code class="language-julia hljs">docs = [
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;A123&quot;, &quot;amount&quot; : 500, &quot;status&quot; : &quot;A&quot; }&quot;&quot;&quot;),
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;A123&quot;, &quot;amount&quot; : 250, &quot;status&quot; : &quot;A&quot; }&quot;&quot;&quot;),
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;B212&quot;, &quot;amount&quot; : 200, &quot;status&quot; : &quot;A&quot; }&quot;&quot;&quot;),
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;A123&quot;, &quot;amount&quot; : 300, &quot;status&quot; : &quot;D&quot; }&quot;&quot;&quot;)
]

collection = client[&quot;my-database&quot;][&quot;aggregation-collection&quot;]
append!(collection, docs)

# Sets the pipeline command
bson_pipeline = Mongoc.BSON(&quot;&quot;&quot;
    [
        { &quot;$match&quot; : { &quot;status&quot; : &quot;A&quot; } },
        { &quot;$group&quot; : { &quot;_id&quot; : &quot;$cust_id&quot;, &quot;total&quot; : { &quot;$sum&quot; : &quot;$amount&quot; } } }
    ]
&quot;&quot;&quot;)

for doc in Mongoc.aggregate(collection, bson_pipeline)
  println(doc)
end</code></pre><p>The result of the script above is:</p><pre><code class="language-julia hljs">BSON(&quot;{ &quot;_id&quot; : &quot;B212&quot;, &quot;total&quot; : 200 }&quot;)
BSON(&quot;{ &quot;_id&quot; : &quot;A123&quot;, &quot;total&quot; : 750 }&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/collection.jl#L341-L383">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.QueryFlags" href="#Mongoc.QueryFlags"><code>Mongoc.QueryFlags</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>QueryFlags</code> correspond to the MongoDB wire protocol. They may be bitwise or’d together. They may modify how a query is performed in the MongoDB server.</p><p>These flags are passed as optional argument for the aggregation function <code>Mongoc.aggregate</code>.</p><p>This data type mirrors C struct <code>mongoc_query_flags_t</code>. See <a href="http://mongoc.org/libmongoc/current/mongoc_query_flags_t.html">libmongoc docs</a> for more information.</p><p><strong>Constants</strong></p><p><code>Mongoc.QUERY_FLAG_NONE</code>: Specify no query flags.</p><p><code>Mongoc.QUERY_FLAG_TAILABLE_CURSOR</code>: Cursor will not be closed when the last data is retrieved. You can resume this cursor later.</p><p><code>Mongoc.QUERY_FLAG_SLAVE_OK</code>: Allow query of replica set secondaries.</p><p><code>Mongoc.QUERY_FLAG_OPLOG_REPLAY</code>: Used internally by MongoDB.</p><p><code>Mongoc.QUERY_FLAG_NO_CURSOR_TIMEOUT</code>: The server normally times out an idle cursor after an inactivity period (10 minutes). This prevents that.</p><p><code>Mongoc.QUERY_FLAG_AWAIT_DATA</code>: Use with <code>Mongoc.MONGOC_QUERY_TAILABLE_CURSOR</code>. Block rather than returning no data. After a period, time out.</p><p><code>Mongoc.QUERY_FLAG_EXHAUST</code>: Stream the data down full blast in multiple &quot;reply&quot; packets. Faster when you are pulling down a lot of data and you know you want to retrieve it all.</p><p><code>Mongoc.QUERY_FLAG_PARTIAL</code>: Get partial results from mongos if some shards are down (instead of throwing an error).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/types.jl#L2-L42">source</a></section></article><h2 id="Session"><a class="docs-heading-anchor" href="#Session">Session</a><a id="Session-1"></a><a class="docs-heading-anchor-permalink" href="#Session" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.transaction" href="#Mongoc.transaction"><code>Mongoc.transaction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transaction(f::Function, client::Client; session_options::SessionOptions=SessionOptions())</code></pre><p>Use <em>do-syntax</em> to execute a transaction.</p><p>Transaction will be commited automatically. If an error occurs, the transaction is aborted.</p><p>The <code>session</code> parameter should be treated the same way as a <code>Client</code>: from a <code>session</code> you get a <code>database</code>, and a <code>collection</code> that are bound to the session.</p><pre><code class="language-julia hljs">Mongoc.transaction(client) do session
    database = session[&quot;my_database&quot;]
    collection = database[&quot;my_collection&quot;]
    new_item = Mongoc.BSON()
    new_item[&quot;inserted&quot;] = true
    push!(collection, new_item)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/session.jl#L176-L196">source</a></section></article><h2 id="GridFS"><a class="docs-heading-anchor" href="#GridFS">GridFS</a><a id="GridFS-1"></a><a class="docs-heading-anchor-permalink" href="#GridFS" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Mongoc.MongoStreamFile" href="#Mongoc.MongoStreamFile"><code>Mongoc.MongoStreamFile</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MongoStreamFile(filepath;
    [flags=JL_O_RDONLY], [mode=0],
    [timeout_msec=DEFAULT_TIMEOUT_MSEC],
    [chunk_size=DEFAULT_CHUNK_SIZE])</code></pre><p>Creates a stream from file located at <code>filepath</code>.</p><p><code>flags</code> is the input to pass to <code>open</code>. Must be one of the constants defined at <code>Base.Filesystem</code>: <code>Base.Filesystem.JL_O_RDONLY</code>, <code>Base.Filesystem.JL_O_CREAT</code>, etc.</p><p><code>mode</code> is an optional mode to pass to <code>open</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/streams.jl#L2-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.upload" href="#Mongoc.upload"><code>Mongoc.upload</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">upload(bucket::Bucket, filename::AbstractString, source::AbstractMongoStream;
    options::Union{Nothing, BSON}=nothing,
    file_id=BSONObjectId())</code></pre><p>Uploads data from <code>source</code> to a GridFS file <code>filename</code>.</p><p><code>bson_file_id</code> is a BSON document with a <code>_id</code> field. If <code>_id</code> field is not present, a <code>BSONObjectId</code> will be generated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L2-L11">source</a></section><section><div><pre><code class="nohighlight hljs">upload(bucket::Bucket, remote_filename::AbstractString, local_source_filepath::AbstractString;
    options::Union{Nothing, BSON}=nothing,
    file_id=BSONObjectId())</code></pre><p>High-level interface to upload a local file to a GridFS bucket.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L71-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.download" href="#Mongoc.download"><code>Mongoc.download</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">download(bucket::Bucket, file_id, target::AbstractMongoStream)</code></pre><p>Download a GridFS file identified by <code>file_id</code> to <code>target</code> stream.</p><p><code>file_id</code> may be either a <code>BSONValue</code> or a <code>BSON</code> document with an <code>_id</code> field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L94-L100">source</a></section><section><div><pre><code class="nohighlight hljs">download(bucket::Bucket, remote_file, local_filepath::AbstractString;
    flags::Integer=(Base.Filesystem.JL_O_CREAT | Base.Filesystem.JL_O_RDWR), mode::Integer=0o600</code></pre><p>Downloads a GridFS file <code>remote_file</code> to <code>local_filepath</code>.</p><p><code>remote_file</code> can be either a unique filename, or a <code>file_id::BSONValue</code>, or <code>file_info::BSON</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L148-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.delete" href="#Mongoc.delete"><code>Mongoc.delete</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">delete(bucket::Bucket, file_id)
delete(bucket::Bucket, file_metadata::BSON)</code></pre><p>Deletes a file from a GridFS Bucket.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L180-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.open_download_stream" href="#Mongoc.open_download_stream"><code>Mongoc.open_download_stream</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">open_download_stream(f, bucket, filename)
open_download_stream(bucket, filename) :: MongoIOStream</code></pre><p>Opens a stream for reading a remote file identified by <code>filename</code>.</p><p><strong>Example</strong></p><p>Open a stream, do some work, then close it.</p><pre><code class="language-julia hljs">io = Mongoc.open_download_stream(bucket, file)
try
    tmp_str = read(io, String)
finally
    close(io)
end</code></pre><p>Use <em>do-syntax</em> to ensure that the <code>io</code> stream will be closed in case something goes wrong.</p><pre><code class="language-julia hljs">Mongoc.open_download_stream(bucket, remote_filename) do io
    tmp_str = read(io, String)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L246-L273">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.open_upload_stream" href="#Mongoc.open_upload_stream"><code>Mongoc.open_upload_stream</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">open_upload_stream(bucket, file_id, filename; [options], [timeout_msec], [chunk_size]) :: MongoIOStream
open_upload_stream(bucket, filename; [options], [timeout_msec], [chunk_size]) :: MongoIOStream
open_upload_stream(bucket, file_info; [options], [timeout_msec], [chunk_size]) :: MongoIOStream</code></pre><p>Opens a stream to upload a file to a GridFS Bucket.</p><p><code>file_info</code> is a BSON document with the following fields:</p><ul><li><p><code>_id</code> as an optional identifier.</p></li><li><p><code>filename</code> as the name of the file in the remote bucket.</p></li></ul><p>If <code>_id</code> is not provided, a <code>BSONObjectId</code> will be generated.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">data = rand(UInt8, 3_000_000)
remote_filename = &quot;uploaded.data&quot;
io = Mongoc.open_upload_stream(bucket, remote_filename)
write(io, data)
close(io)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/gridfs.jl#L325-L349">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Mongoc.abort_upload" href="#Mongoc.abort_upload"><code>Mongoc.abort_upload</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">abort_upload(io::MongoIOStream)</code></pre><p>Aborts the upload of a GridFS upload stream.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/23212825d15df2bdcbc59fd9969f717ca2aeb312/src/streams.jl#L43-L47">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../logging/">« Logging</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Sunday 19 June 2022 20:24">Sunday 19 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
